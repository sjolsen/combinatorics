\documentclass{article}
\usepackage{fullpage}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsfonts}
\usepackage{titlesec}
\usepackage{tikz}

\renewcommand{\thesubsection}{\arabic{subsection}}
\titleformat{\subsection}[runin]{\normalfont\large\bfseries}{\thesubsection.}{0em}{}[]

\newsavebox\secindentbox
\newlength\secprewidth
\newlength\sectextwidth

\newcommand{\problem}[2]{%
  \setcounter{subsection}{\the\numexpr#1-1}%
  \savebox{\secindentbox}{\normalfont\large\bfseries #1.\ \hspace{1.95831pt}}%
  \settowidth{\secprewidth}{\usebox{\secindentbox}}%
  \setlength{\sectextwidth}{\textwidth}%
  \addtolength{\sectextwidth}{-\secprewidth}%
  \subsection{}{\parbox[t]{\sectextwidth}{\large #2}}%
  \vspace{\baselineskip}%
}

\usetikzlibrary{calc}
\newcommand{\tikzmark}[1]{\tikz[overlay,remember picture]\node(#1){};}
\newcommand{\overbox}[1]{%
  \tikzmark{bl}%
  #1%
  \tikzmark{br}%
  \tikz[overlay,remember picture]{%
    \draw ($(bl)+(-0.2em,1em)$) rectangle ($(br)+(0.2em,-0.4em)$);%
  }%
}

\newcommand{\card}[1]{\left\lvert#1\right\rvert}
\newcommand{\pset}{\mathcal{P}}
\newcommand{\suchthat}{:}
\newcommand{\divides}{\mathbin{|}}
\newcommand{\floor}[1]{\left\lfloor#1\right\rfloor}
\renewcommand{\emptyset}{\varnothing}
\DeclareMathOperator{\lcm}{lcm}
\newcommand{\answer}[1]{\overbox{#1}}
\newcommand{\compl}[1]{\overline{#1}}

\allowdisplaybreaks


\title{MATH 4350 -- Homework 4}
\author{Stuart Olsen}
\date{April 8, 2015}

\begin{document}
\maketitle


\section*{Chapter 6.7}
\problem{1}{
  Find the number of integers between $1$ and $10000$ inclusive that are not divisible by $4$, $5$, or $6$.
}
% (labels ((divides (a b)
%            (zerop (nth-value 1 (floor b a)))))
%   (loop
%      for i from 1 to 10000
%      when (notany (lambda (j) (divides j i)) '(4 5 6))
%      counting 1))
% => 5334

Theorem 6.1.1 gives us that this number is given by
\begin{align*}
  \card{S} - \sum_{\{i\} \in \pset_1(J)}\card{A_i} + \sum_{\{i, j\} \in \pset_2(J)}\card{A_i \cap A_j} - \sum_{\{i, j, k\} \in \pset_3(J)}\card{A_i \cap A_j \cap A_k}
\end{align*}
where $S = \{1, \ldots, 10000\}$, $A_i = \{x \in S \suchthat i \divides x\}$, $J = \{4,5,6\}$, and $\pset_\kappa(X) = \{X^\prime \in \pset(X) \suchthat \card{X^\prime} = \kappa\}$.

The cardinality of $S$ is $10000$ and those of $A_i$ are given by $\floor{\frac{\card{S}}{i}}$:
\begin{align*}
  \card{A_4} &= \floor{\frac{10000}{4}} = 2500;\\
  \card{A_5} &= \floor{\frac{10000}{5}} = 2000;\\
  \card{A_6} &= \floor{\frac{10000}{6}} = 1666.
\end{align*}
Further, the cardinalities of $\bigcap_{i \in J^\prime}{A_i}$ for $J^\prime$ in $\pset_{\ge2}(J)$ are given by $\card{A_{\lcm(J^\prime)}}$:
\begin{align*}
  \card{A_4 \cap A_5} &= \card{A_{20}} = \floor{\frac{10000}{20}} = 500;\\
  \card{A_4 \cap A_6} &= \card{A_{12}} = \floor{\frac{10000}{12}} = 833;\\
  \card{A_5 \cap A_6} &= \card{A_{30}} = \floor{\frac{10000}{30}} = 333;\\
  \card{A_4 \cap A_5 \cap A_6} &= \card{A_{60}} = \floor{\frac{10000}{60}} = 166.
\end{align*}
Then, the number of integers between $1$ and $10000$ inclusive that are not divisible by $4$, $5$, or $6$ is given by
\begin{align*}
  &\begin{aligned}
    10000 &- \left( 2500 + 2000 + 1666 \right)\\
    &+ \left( 500 + 833 + 333 \right)\\
    &- \left( 166 \right)
  \end{aligned}\\
  =\ &\begin{aligned}
    10000 - 6166 + 1666 - 166
  \end{aligned}\\
  =\ &\begin{aligned}
    \answer{5334}
  \end{aligned}.
\end{align*}


\problem{4}{
  Determine the number of $12$-combinations of the multiset
  \begin{align*}
    S = \{4 \cdot a, 3 \cdot b, 4 \cdot c, 5 \cdot d\}.
  \end{align*}
}
Let $S^*$ denote the extension of $S$ to infinite repetition numbers (i.e. $\{\infty \cdot a, \infty \cdot b, \infty \cdot c, \infty \cdot d\}$), $T$ the set of $12$-combinations of $S^*$, $J$ the set $\{a, b, c, d\}$, and $A_{\alpha \in J}$ the set of all elements of $T$ containing more than $k_\alpha$ $\alpha$s, where $k_\alpha$ is the repetition number of $\alpha$ in $S$. Then, the number of $12$-combinations of $S$ is given by $\card{\compl{A_a} \cap \compl{A_b} \cap \compl{A_c} \cap \compl{A_d}}$, where $\compl{A_\alpha} = T \setminus A_\alpha$. By theorem 6.1.1:
\begin{align*}
  \card{\compl{A_a} \cap \compl{A_b} \cap \compl{A_c} \cap \compl{A_d}} &= \card{T}\\
    &- \sum_{\{i\} \in \pset_1(J)}\card{A_i}\\
    &+ \sum_{\{i, j\} \in \pset_2(J)}\card{A_i \cap A_j}\\
    &- \sum_{\{i, j, k\} \in \pset_3(J)}\card{A_i \cap A_j \cap A_k}\\
    &+ \sum_{\{i, j, k, l\} \in \pset_4(J)}\card{A_i \cap A_j \cap A_k \cap A_l}.
\end{align*}

The cardinality of $T$ is given by
\begin{align*}
  {{12 + 4 - 1} \choose {12}} = 455.
\end{align*}
For each $J^\prime \in \pset_{>0}(J)$, the cardinality of $\bigcap_{\alpha \in J^\prime}A_\alpha$ is the same as that of the set of $(12-\sum_{\alpha \in J^\prime}(k_\alpha+1))$-combinations of $S^*$ (by the reasoning given in example 6.2/1):
\begin{align*}
  \card{\bigcap_{\alpha \in J^\prime}A_\alpha} &= {{(12-\sum_{\alpha \in J^\prime}(k_\alpha+1)) + 4 - 1} \choose {12-\sum_{\alpha \in J^\prime}(k_\alpha+1)}}\\
                                               &= {{15-\card{J^\prime}-\sum_{\alpha \in J^\prime}k_\alpha} \choose {12-\card{J^\prime}-\sum_{\alpha \in J^\prime}k_\alpha}}.
\end{align*}
Then,
\begin{align*}
  \card{A_a} &= {{15 - 1 - 4} \choose {12 - 1 - 4}} = {{10} \choose {7}} = 120;\\
  \card{A_b} &= {{15 - 1 - 3} \choose {12 - 1 - 3}} = {{11} \choose {8}} = 165;\\
  \card{A_c} &= {{15 - 1 - 4} \choose {12 - 1 - 4}} = {{10} \choose {7}} = 120;\\
  \card{A_d} &= {{15 - 1 - 5} \choose {12 - 1 - 5}} = {{9} \choose {6}} = 84;\\
  \card{A_a \cap A_b} &= {{15 - 2 - (4 + 3)} \choose {12 - 2 - (4 + 3)}} = {{6} \choose {3}} = 20;\\
  \card{A_a \cap A_c} &= {{15 - 2 - (4 + 4)} \choose {12 - 2 - (4 + 4)}} = {{5} \choose {2}} = 10;\\
  \card{A_a \cap A_d} &= {{15 - 2 - (4 + 5)} \choose {12 - 2 - (4 + 5)}} = {{4} \choose {1}} = 4;\\
  \card{A_b \cap A_c} &= {{15 - 2 - (3 + 4)} \choose {12 - 2 - (3 + 4)}} = {{6} \choose {3}} = 20;\\
  \card{A_b \cap A_d} &= {{15 - 2 - (3 + 5)} \choose {12 - 2 - (3 + 5)}} = {{5} \choose {2}} = 10;\\
  \card{A_c \cap A_d} &= {{15 - 2 - (4 + 5)} \choose {12 - 2 - (4 + 5)}} = {{4} \choose {1}} = 4;\\
  \card{A_a \cap A_b \cap A_c} &= {{15 - 3 - (4 + 3 + 4)} \choose {12 - 3 - (4 + 3 + 4)}} = {{1} \choose {-2}} = 0;\\
  \card{A_a \cap A_b \cap A_d} &= {{15 - 3 - (4 + 3 + 5)} \choose {12 - 3 - (4 + 3 + 5)}} = {{0} \choose {-3}} = 0;\\
  \card{A_a \cap A_c \cap A_d} &= {{15 - 3 - (4 + 4 + 5)} \choose {12 - 3 - (4 + 4 + 5)}} = {{-1} \choose {-4}} = 0;\\
  \card{A_b \cap A_c \cap A_d} &= {{15 - 3 - (3 + 4 + 5)} \choose {12 - 3 - (3 + 4 + 5)}} = {{0} \choose {-3}} = 0;\\
  \card{A_a \cap A_b \cap A_c \cap A_d} &= {{15 - 4 - (4 + 3 + 4 + 5)} \choose {12 - 4 - (4 + 3 + 4 + 5)}} = {{-5} \choose {-8}} = 0.
\end{align*}
Then, the number of $12$-combinations of $S$ is given by
\begin{align*}
  &\begin{aligned}
    455 &- \left( 120 + 165 + 120 + 84 \right)\\
    &+ \left( 20 + 10 + 4 + 20 + 10 + 4 \right)\\
    &- \left( 0 + 0 + 0 + 0 \right)\\
    &+ \left( 0 \right)
  \end{aligned}\\
  =\ &\begin{aligned}
    455 - 489 + 68 - 0 + 0
  \end{aligned}\\
  =\ &\begin{aligned}
    \answer{34}
  \end{aligned}.
\end{align*}


\problem{8}{
  Determine the number of solutions of the equation $x_1 + x_2 + x_3 + x_4 + x_5 = 14$ in positive integers $x_1$, $x_2$, $x_3$, $x_4$, and $x_5$ not exceeding $5$.
}


\problem{11}{
  Determine the number of permutations of $\{1, 2, \ldots, 8\}$ in which no even integer is in its natural position.
}


\problem{15}{
  At a party, seven gentlemen check their hats. In how many ways can their hats be returned so that
  \begin{enumerate}
  \item no gentleman receives his own hat?
  \item at least one of the gentlemen receives his own hat?
  \item at least two of the gentlemen receive their own hats?
  \end{enumerate}
}


\end{document}
