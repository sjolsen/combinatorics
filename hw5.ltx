\documentclass{homework}
\usepackage{fullpage}



\title{MATH 4350 -- Homework 5}
\author{Stuart Olsen}
% \date{April 8, 2015}

\begin{document}
\maketitle


\begin{lemma}\label{f-combination}
  If $n$ is an integer greater than zero, then for all $m>n$, $f_m = f_{m-n+1} \cdot f_n + f_{m-n} \cdot f_{n-1}$.
\end{lemma}
\begin{proof}
  Consider whether $m=n+1$ or $m>n+1$:
  \begin{caselist}
    \case{$m=n+1$}{
      \vspace{-\baselineskip} % FIXME
      \begin{align*}
        f_m &= f_{m-1} + f_{m-2}\\
            &= f_{n} + f_{n-1}\\
            &= 1 \cdot f_{n} + 1 \cdot f_{n-1}\\
            &= f_2 \cdot f_{n} + f_1 \cdot f_{n-1}\\
            &= f_{m-n+1} \cdot f_n + f_{m-n} \cdot f_{n-1}.
      \end{align*}
    }
    \case{$m>n+1$}{
      Suppose that for all $k<m$, if $k>n$ then $f_k = f_{k-n+1} \cdot f_n + f_{k-n} \cdot f_{n-1}$. Then,
      \begin{align*}
        f_{m} &= f_{m-1} + f_{m-2}\\
              &= (f_{m-1-n+1} \cdot f_n + f_{m-1-n} \cdot f_{n-1}) + (f_{m-2-n+1} \cdot f_n + f_{m-2-n} \cdot f_{n-1})\\
              &= (f_{m-1-n+1} + f_{m-2-n+1}) \cdot f_n + (f_{m-1-n} + f_{m-2-n}) \cdot f_{n-1}\\
              &= (f_{m-n+1-1} + f_{m-n+1-2}) \cdot f_n + (f_{m-n-1} + f_{m-n-2}) \cdot f_{n-1}\\
              &= f_{m-n+1} \cdot f_n + f_{m-n} \cdot f_{n-1}.
      \end{align*}
    }
  \end{caselist}
  Then, by strong induction, $f_m = f_{m-n+1} \cdot f_n + f_{m-n} \cdot f_{n-1}$.
\end{proof}

\begin{lemma}\label{f-is-divisibility-sequence}
  For all $m, n \in \bn$ with $n \ge 3$, $f_n \divides f_m$ if and only if $n \divides m$.
\end{lemma}
\begin{proof}
  We proceed in two parts:
  \begin{caselist}
    \case{$n \divides m \implies f_n \divides f_m$}{
      Assume $n \divides m$; then, we have some integer $p \ge 1$ such that $m = p \cdot n$. We proceed by induction on $p$:
      \begin{caselist}
        \case{$p=1$}{
          Since $p=1$, $n=m$. Since $0 \ndivides 0$, then, $n$ (and $m$) is greater than zero, and so $f_n=f_m$ is greater than zero. Then, $f_n \divides f_m$.
        }
        \case{$p>1$}{
          Assume $f_n \divides f_{(p-1)n}$; then, there is some $q \ge 1$ such that $f_{(p-1)n} = q \cdot f_n$. Then,
          \begin{align*}
            f_{m} &= f_{m-n+1} \cdot f_n + f_{m-n} \cdot f_{n-1}\quad(\text{by Lemma \ref{f-combination}})\\
                  &= f_{m-n+1} \cdot f_n + f_{(p-1)n} \cdot f_{n-1}\\
                  &= f_{m-n+1} \cdot f_n + q \cdot f_n \cdot f_{n-1}\\
                  &= (f_{m-n+1} + q \cdot f_{n-1}) \cdot f_n,
          \end{align*}
          and so $f_n \divides f_m$.
        }
      \end{caselist}
      Then, by weak induction on p, we have $n \divides m \implies f_n \divides f_m$.
    }
    \case{$f_n \divides f_m \implies n \divides m$}{
      Suppose $n \ndivides m$. Then, there are integers $q$ and $r$ such that $0 < r < n$ and $m = q \cdot n + r$. We proceed by induction on $q$:
      \begin{caselist}
        \case{$q=0$}{
          We have $m = r$, so $0 < m < n$, and so $0 < f_m \le f_n$. Because $n \ge 3$ and the Fibonacci sequence is monotonically increasing from index $2$ and up, we then have $f_m < f_n$. Then, $f_n \ndivides f_m$, as no positive number divides a nonzero number less than itself.
        }
        \case{$q > 0$}{
          Assume $f_n \ndivides f_{(q-1)n + r}$. Suppose $f_n \divides f_m$; then, there is some $p \in \bn$ such that $f_m = p \cdot f_n$. Note that $m>n$. Then, by application of Lemma \ref{f-combination},
          \begin{align*}
            f_{m} &= f_{m-n+1} \cdot f_n + f_{m-n} \cdot f_{n-1}\\
            p \cdot f_{n} &= f_{m-n+1} \cdot f_n + f_{m-n} \cdot f_{n-1}\\
            p \cdot f_{n} - f_{m-n+1} \cdot f_n &= f_{m-n} \cdot f_{n-1}\\
            (p - f_{m-n+1}) \cdot f_n &= f_{m-n} \cdot f_{n-1}\\
            (p - f_{m-n+1}) \cdot f_n &= f_{(q \cdot n + r)-n} \cdot f_{n-1}\\
            (p - f_{m-n+1}) \cdot f_n &= f_{(q-1)n + r} \cdot f_{n-1}.
          \end{align*}
          Then, $f_n \divides f_{(q-1)n + r} \cdot f_{n-1}$. Because $f_n \ndivides f_{(q-1)n + r}$, $f_n | f_{n-1}$, which contradicts the fact that no positive number (e.g. $f_n$) divides a nonzero number (e.g. $f_{n-1}$) less than itself. Then, $f_n \ndivides f_m$.
        }
      \end{caselist}
      Thus, by weak induction on $q$, we have $f_n \ndivides f_m$. Therefore, $n \ndivides m \implies f_n \ndivides f_m$, and so by contraposition, $f_n \divides f_m \implies n \divides m$.
    }
  \end{caselist}
\end{proof}



\section*{Chapter 7.7}
\problem{3}{
  Prove the following about the Fibonacci numbers:
}
\subproblem{a}{
  $f_n$ is even if and only if $n$ is divisible by $3$.
}
$f_3 = 2$; then, by Lemma \ref{f-is-divisibility-sequence}, $f_n$ is even (i.e., $2$ divides $f_n$) if and only if $3$ divides $n$.


\subproblem{b}{
  $f_n$ is divisible by $3$ if and only if $n$ is divisible by $4$.
}
$f_4 = 3$; then, by Lemma \ref{f-is-divisibility-sequence}, $3$ divides $f_n$ if and only if $4$ divides $n$.


\subproblem{c}{
  $f_n$ is divisible by $4$ if and only if $n$ is divisible by $6$.
}
\begin{proof}
  We proceed in two parts:
  \begin{caselist}
    \case{$6 \divides n \implies 4 \divides f_n$}{
      $f_6=8$, so by Lemma \ref{f-is-divisibility-sequence}, if $n$ is divisible by $6$, $f_n$ is divisible by $8$, and thus by $4$.
    }
    \case{$4 \divides f_n \implies 6 \divides n$}{
      Assume $4 \divides f_n$; then, $2 \divides f_n$, so by Lemma \ref{f-is-divisibility-sequence}, $3 \divides n$. Suppose $2 \ndivides n$. From $3 \divides n$ and $2 \ndivides n$, we know $n = 6 \cdot p + 3$ for some $p \in \bn$. We proceed by induction on $p$:
      \begin{caselist}
        \case{$p=0$}{
          $n=3$, so $f_n=2$, from which it follows that $4 \ndivides f_n$.
        }
        \case{$p > 0$}{
          Assume $4 \ndivides f_{6(p-1)+3}$. Suppose $4 \divides f_n$; then, there is some $q \in \bn$ such that $f_n = 4 \cdot q$. From $p > 0$, we have $n>6$, so by Lemma \ref{f-combination},
          \begin{align*}
            f_n &= f_{n-6+1} \cdot f_6 + f_{n-6} \cdot f_{6-1}\\
            4 \cdot q &= f_{n-5} \cdot 8 + f_{n-6} \cdot 5\\
            4 \cdot q &= 4 \cdot (2 \cdot f_{n-5}) + f_{n-6} \cdot 5\\
            4 \cdot q - 4 \cdot (2 \cdot f_{n-5}) &= f_{n-6} \cdot 5\\
            4 \cdot (q - 2 \cdot f_{n-5}) &= f_{n-6} \cdot 5\\
            4 \cdot (q - 2 \cdot f_{n-5}) &= f_{(6p+3)-6} \cdot 5\\
            4 \cdot (q - 2 \cdot f_{n-5}) &= f_{6(p-1)+3} \cdot 5.
          \end{align*}
          Then, $4 \divides f_{6(p-1)+3} \cdot 5$. Because $4 \ndivides 5$, then, $4 \divides f_{6(p-1)+3}$, which is a contradiction. Therefore, $4 \ndivides f_n$.
        }
      \end{caselist}
      Thus, by weak induction, $4 \ndivides f_n$, which is a contradiction. Therefore, $2 \divides n$, and so $6 \divides n$.
    }
  \end{caselist}
\end{proof}



\problem{4}{
  Prove that the Fibonacci sequence is the solution of the recurrence relation
  \begin{align*}
    a_n = 5a_{n-4} + 3a_{n-5},\quad(n \ge 5),
  \end{align*}
  where $a_0 = 0$, $a_1 = 1$, $a_2 = 1$, $a_3 = 2$, and $a_4 = 3$. Then use this formula to show that the Fibonacci numbers satisfy the condition that $f_n$ is divisible by $5$ if and only if $n$ is divisible by $5$.
}
For $n \le 4$, the given $a_n$ equal $f_n$. For $n > 4$, $f_n = a_n$ follows directly from Lemma \ref{f-combination}. Since $f_5 = 5$, $5 \divides f_n \iff 5 \divides n$ follows directly from Lemma \ref{f-is-divisibility-sequence}, which uses Lemma \ref{f-combination}.


\problem{8}{
  Consider a $1$-by-$n$ chessboard. Suppose we color each square of the chessboard with one of the two colors red and blue. Let $h_n$ be the number of colorings in which no two squares that are colored red are adjacent. Find and verify a recurrence relation that $h_n$ satisfies. Then derive a formula for $h_n$.
}
\incomplete{}


\problem{11}{
  The {\it Lucas numbers} $l_0, l_1, l_2, \ldots, l_n, \ldots$ are defined using the same recurrence relations defining the Fibonacci numbers, but with different initial conditions:
  \begin{align*}
    l_n = l_{n-1} + l_{n-2},\quad(n \ge 2), l_0 = 2, l_1 = 1.
  \end{align*}
  Prove that
  \begin{enumerate}[label=(\alph*)]
  \item $l_n = f_{n-1} + f_{n+1}$ for $n \ge 1$.
  \item $l_0^2 + l_1^2 + \cdots + l_n^2 = l_nl_{n+1} + 2$ for $n \ge 0$.
  \end{enumerate}
}
\incomplete{}


\problem{12}{
  Let $h_0, h_1, h_2, \ldots, h_n, \ldots$ be the sequence defined by
  \begin{align*}
    h_n = n^3,\quad(n \ge 0).
  \end{align*}
  Show that $h_n = h_{n-1} + 3n^2 - 3n + 1$ is the recurrence relation for the sequence.
}
\incomplete{}


\problem{13}{%a,b
  Determine the generating function for each of the following sequences:
  \begin{enumerate}[label=(\alph*)]
  \item $c^0 = 1, c, c^2, \ldots, c^n, \ldots$
  \item $1, -1, 1, -1, \ldots, (-1)^n, \ldots$
  \end{enumerate}
}
\incomplete{}


\problem{16}{
  Formulate a combinatorial problem for which the generating function is
  \begin{align*}
    (1 + x + x^2)(1 + x^2 + x^4 + x^6)(1 + x^2 + x^4 + \cdots)(x + x^2 + x^3 + \cdots).
  \end{align*}
}
\incomplete{}


\problem{17}{
  Determine the generating function for the number $h_n$ of bags of fruit of apples, oranges, bananas, and pears in which there are an even number of apples, at most two oranges, a multiple of three number of bananas, and at most one pear. Then find a formula for $h_n$ from the generating function.
}
\incomplete{}


\problem{19}{
  Let $h_0, h_1, h_2, \ldots, h_n, \ldots$ be the sequence defined by $h_n = {n \choose 2}, (n \ge 0)$. Determine the generating function for the sequence.
}
\incomplete{}


\problem{22}{
  Determine the exponential generating function for the sequence of factorials: $0!, 1!, 2!, 3!, \ldots, n!, \ldots$.
}
\incomplete{}


\problem{31}{
  Solve the recurrence relation $h_n = 4h_{n-2}, (n \ge 2)$ with initial values $h_0 = 0$ and $h_1 = 1$.
}
\incomplete{}


\problem{42}{
  Solve the nonhomogeneous recurrence relation
  \begin{align*}
    h_n &= 4h_{n-1} + 4^n,\quad(n \ge 1)\\
    h_0 &= 3.
  \end{align*}
}
\incomplete{}



\end{document}
